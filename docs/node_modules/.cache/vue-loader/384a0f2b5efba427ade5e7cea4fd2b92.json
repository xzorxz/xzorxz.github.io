{"remainingRequest":"/Users/xiaozhang/学习/就业班学习/vue-实战/hmmm-frontend-dev/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xiaozhang/学习/就业班学习/vue-实战/hmmm-frontend-dev/src/module-manage/components/permissionsApi-add.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xiaozhang/学习/就业班学习/vue-实战/hmmm-frontend-dev/src/module-manage/components/permissionsApi-add.vue","mtime":1668225793867},{"path":"/Users/xiaozhang/学习/就业班学习/vue-实战/hmmm-frontend-dev/node_modules/cache-loader/dist/cjs.js","mtime":1666491533034},{"path":"/Users/xiaozhang/学习/就业班学习/vue-实战/hmmm-frontend-dev/node_modules/thread-loader/dist/cjs.js","mtime":1666491532143},{"path":"/Users/xiaozhang/学习/就业班学习/vue-实战/hmmm-frontend-dev/node_modules/babel-loader/lib/index.js","mtime":1667719626894},{"path":"/Users/xiaozhang/学习/就业班学习/vue-实战/hmmm-frontend-dev/node_modules/cache-loader/dist/cjs.js","mtime":1666491533034},{"path":"/Users/xiaozhang/学习/就业班学习/vue-实战/hmmm-frontend-dev/node_modules/vue-loader/lib/index.js","mtime":1666491603796}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IGRldGFpbCwgdXBkYXRlLCBhZGQgfSBmcm9tICdAL2FwaS9iYXNlL3Blcm1pc3Npb25zJwppbXBvcnQgeyBsaXN0IH0gZnJvbSAnQC9hcGkvYmFzZS9tZW51cy5qcycKbGV0IF90aGlzID0gW10KZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdQZXJtaXNzaW9uR3JvdXBzQXBpQWRkJywKICBwcm9wczogWydhcGlUaXRsZScsICdydWxlSW5saW5lJ10sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIFBlcm1pc3Npb25Hcm91cHNtZW51OiBbXSwKICAgICAgZGVmYXVsdFByb3BzOiB7CiAgICAgICAgbGFiZWw6ICd0aXRsZScKICAgICAgfSwKICAgICAgZm9ybUJhc2U6IHsKICAgICAgICBpZDogMCwKICAgICAgICB0aXRsZTogJycsCiAgICAgICAgYXBpczogW10KICAgICAgfSwKICAgICAgUGVybWlzc2lvbkFwaURhdGE6IFtdLAogICAgICBjaGVja2VkRGF0YTogW10KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDoj5zljZXmnYPpmZDmoJEKICAgIHRyZWVEYXRhICgpIHsKICAgICAgY29uc3QgY2hlY2tlZERhdGEgPSB0aGlzLlBlcm1pc3Npb25BcGlEYXRhCgogICAgICBjb25zdCBjaGVja2VkID0gZmFsc2UKICAgICAgaWYgKF90aGlzICE9PSBudWxsICYmIF90aGlzLmZvcm1CYXNlLmFwaXMubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnN0IHBlciA9IF90aGlzLmZvcm1CYXNlLmFwaXMubWFwKGl0ZW0gPT4gewogICAgICAgICAgcmV0dXJuIGl0ZW0KICAgICAgICB9KQogICAgICAgIGNvbnN0IHVzZSA9IHBlci5tYXAoaXRlbSA9PiB7CiAgICAgICAgICBjaGVja2VkRGF0YS5maWx0ZXIobWluaSA9PiB7CiAgICAgICAgICAgIGlmIChtaW5pLmlkID09PSBpdGVtKSB7CiAgICAgICAgICAgICAgbWluaS5jaGVja2VkID0gdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgIH0KICAgICAgcmV0dXJuIGNoZWNrZWREYXRhCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDpgLvovpHkuJrliqEKICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgIC8vIOW8ueWxguaYvuekugogICAgZGlhbG9nRm9ybVYgKCkgewogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZQogICAgfSwKICAgIC8vIOW8ueWxgumakOiXjwogICAgZGlhbG9nRm9ybUggKCkgewogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2UKICAgIH0sCiAgICAvLyDpgIDlh7oKICAgIGhhbmRsZUNsb3NlICgpIHsKICAgICAgdGhpcy4kZW1pdCgnaGFuZGxlQ2xvc2VNb2RhbCcpCiAgICB9LAogICAgLy8g6IqC54K55aSN6YCJ5qGG6KKr6YCJ5LitCiAgICBoYW5kbGVDaGVja0NoYW5nZSAobm9kZXMpIHsKICAgICAgdmFyIGNoZWNrZWREYXRhID0gW10KICAgICAgY2hlY2tlZERhdGEucHVzaChub2RlcykKICAgIH0sCiAgICAvLyDpq5jnuqfmjqXlj6PmlbDmja7liJfooagKICAgIGxvYWRBcGlQZXJtaXNzaW9uRGF0YSAoKSB7CiAgICAgIGxpc3QoKS50aGVuKChyZXQsIGVycikgPT4gewogICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgIHJldHVybiBlcnIKICAgICAgICB9CiAgICAgICAgX3RoaXMuUGVybWlzc2lvbkFwaURhdGEgPSByZXQuZGF0YQogICAgICB9KQogICAgfSwKICAgIC8vIOmrmOe6p+aOpeWPo+ihqOWNleivpuaDheaVsOaNruWKoOi9vQogICAgaGFubGRlRWRpdEFwaUZvcm0gKG9iamVkaXRJZCkgewogICAgICAvLyDojrflj5bmnYPpmZDmoIfpopgKICAgICAgdGhpcy5mb3JtQmFzZS5pZCA9IG9iamVkaXRJZAogICAgICBkZXRhaWxzKHsgaWQ6IG9iamVkaXRJZCB9KS50aGVuKChyZXQsIGVycikgPT4gewogICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgIHJldHVybiBlcnIKICAgICAgICB9CiAgICAgICAgdGhpcy5mb3JtQmFzZS5pZCA9IHJldC5kYXRhLmlkCiAgICAgICAgdGhpcy5mb3JtQmFzZS50aXRsZSA9IHJldC5kYXRhLnRpdGxlCiAgICAgIH0pCiAgICAgIF90aGlzLmxvYWRBcGlQZXJtaXNzaW9uRGF0YSgpCiAgICAgIC8vIOivu+WPluaOiOadgwogICAgICBhcGlyZWFkKHsgaWQ6IG9iamVkaXRJZCB9KS50aGVuKChyZXQsIGVycikgPT4gewogICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgIHJldHVybiBlcnIKICAgICAgICB9CiAgICAgICAgdGhpcy5mb3JtQmFzZS5hcGlzID0gcmV0LmRhdGEuYXBpcwogICAgICB9KQogICAgfSwKICAgIC8vIOihqOWNleaPkOS6pAogICAgaGFuZGxlU2F2ZSAob2JqZWN0KSB7CiAgICAgIGNvbnN0IGN1ckFwaXMgPSBbXQogICAgICBmb3IgKGNvbnN0IGl0IG9mIF90aGlzLmNoZWNrZWREYXRhKSB7CiAgICAgICAgY3VyQXBpcy5wdXNoKGl0LmlkKQogICAgICB9CiAgICAgIHRoaXMuJHJlZnNbb2JqZWN0XS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB0aGlzLiRlbWl0KCdoYW5kbGVDbG9zZU1vZGFsJykKICAgICAgICAgIGFwaWFkZCh7IGlkOiBfdGhpcy5mb3JtQmFzZS5pZCwgYXBpczogY3VyQXBpcyB9KS50aGVuKChyZXQsIGVycikgPT4gewogICAgICAgICAgICBpZiAoZXJyKSB7CiAgICAgICAgICAgICAgcmV0dXJuIGVycgogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ25ld0RhdGFlcycsIHRoaXMuZm9ybUJhc2UpCiAgICAgICAgICB9KQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKCcq5Y+35Li65b+F5aGr6aG5IScpCiAgICAgICAgfQogICAgICB9KQogICAgfQogIH0sCiAgLy8g5oyC6L2957uT5p2fCiAgbW91bnRlZDogZnVuY3Rpb24gKCkge30sCiAgLy8g5Yib5bu65a6M5q+V54q25oCBCiAgY3JlYXRlZCAoKSB7CiAgICBfdGhpcyA9IHRoaXMKICB9LAogIC8vIOe7hOS7tuabtOaWsAogIHVwZGF0ZWQ6IGZ1bmN0aW9uICgpIHt9Cn0K"},{"version":3,"sources":["permissionsApi-add.vue"],"names":[],"mappings":";AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"permissionsApi-add.vue","sourceRoot":"src/module-manage/components","sourcesContent":["<template>\n  <div class=\"add-form\">\n    <el-dialog :title=\"apiTitle\" :visible.sync=\"dialogFormVisible\">\n    <el-form :rules=\"ruleInline\" ref=\"dataForm\" :model=\"formBase\" label-position=\"left\" label-width=\"120px\" style='width: 400px; margin-left:120px;'>\n          <el-form-item :label=\"$t('table.powerTitle')\" prop=\"title\">\n            <el-input v-model=\"formBase.title\"></el-input>\n          </el-form-item>\n          <el-form-item  :label=\"$t('table.powerDistriB')\">\n            <el-tree\n              ref=\"treeMenu\"\n              :data=\"treeData\"\n              show-checkbox\n              node-key=\"id\"\n              :default-expanded-keys=\"[0]\"\n              :props=\"defaultProps\" @check-change='handleCheckChange'>\n            </el-tree>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"handleClose\">{{$t('table.signOut')}}</el-button>\n          <el-button type=\"primary\" @click=\"handleSave('formBase')\">{{$t('table.preserve')}}</el-button>\n        </div>\n  </el-dialog>\n\n  </div>\n</template>\n<script>\nimport { detail, update, add } from '@/api/base/permissions'\nimport { list } from '@/api/base/menus.js'\nlet _this = []\nexport default {\n  name: 'PermissionGroupsApiAdd',\n  props: ['apiTitle', 'ruleInline'],\n  data () {\n    return {\n      dialogFormVisible: false,\n      PermissionGroupsmenu: [],\n      defaultProps: {\n        label: 'title'\n      },\n      formBase: {\n        id: 0,\n        title: '',\n        apis: []\n      },\n      PermissionApiData: [],\n      checkedData: []\n    }\n  },\n  computed: {\n    // 菜单权限树\n    treeData () {\n      const checkedData = this.PermissionApiData\n\n      const checked = false\n      if (_this !== null && _this.formBase.apis.length > 0) {\n        const per = _this.formBase.apis.map(item => {\n          return item\n        })\n        const use = per.map(item => {\n          checkedData.filter(mini => {\n            if (mini.id === item) {\n              mini.checked = true\n            }\n          })\n        })\n      }\n      return checkedData\n    }\n  },\n  methods: {\n    // 逻辑业务\n    // **********************************\n    // **********************************\n    // 弹层显示\n    dialogFormV () {\n      this.dialogFormVisible = true\n    },\n    // 弹层隐藏\n    dialogFormH () {\n      this.dialogFormVisible = false\n    },\n    // 退出\n    handleClose () {\n      this.$emit('handleCloseModal')\n    },\n    // 节点复选框被选中\n    handleCheckChange (nodes) {\n      var checkedData = []\n      checkedData.push(nodes)\n    },\n    // 高级接口数据列表\n    loadApiPermissionData () {\n      list().then((ret, err) => {\n        if (err) {\n          return err\n        }\n        _this.PermissionApiData = ret.data\n      })\n    },\n    // 高级接口表单详情数据加载\n    hanldeEditApiForm (objeditId) {\n      // 获取权限标题\n      this.formBase.id = objeditId\n      details({ id: objeditId }).then((ret, err) => {\n        if (err) {\n          return err\n        }\n        this.formBase.id = ret.data.id\n        this.formBase.title = ret.data.title\n      })\n      _this.loadApiPermissionData()\n      // 读取授权\n      apiread({ id: objeditId }).then((ret, err) => {\n        if (err) {\n          return err\n        }\n        this.formBase.apis = ret.data.apis\n      })\n    },\n    // 表单提交\n    handleSave (object) {\n      const curApis = []\n      for (const it of _this.checkedData) {\n        curApis.push(it.id)\n      }\n      this.$refs[object].validate(valid => {\n        if (valid) {\n          this.$emit('handleCloseModal')\n          apiadd({ id: _this.formBase.id, apis: curApis }).then((ret, err) => {\n            if (err) {\n              return err\n            }\n            this.$emit('newDataes', this.formBase)\n          })\n        } else {\n          this.$Message.error('*号为必填项!')\n        }\n      })\n    }\n  },\n  // 挂载结束\n  mounted: function () {},\n  // 创建完毕状态\n  created () {\n    _this = this\n  },\n  // 组件更新\n  updated: function () {}\n}\n</script>\n<style>\n.el-tree {\n  margin-top: 8px;\n}\n.el-tree-node__content {\n  height: auto;\n}\n.el-form--label-left .el-form-item__label {\n  text-align: right;\n}\n.el-dialog__footer {\n  text-align: right;\n}\n</style>\n"]}]}